version: '3.8'

services:
  backend:
    environment:
      # Enable the dev auth bypass in local-compose mode
      DEV_AUTH_BYPASS: 'true'
      # Optional: target a specific dev user email. Uncomment and set as needed.
      # DEV_BYPASS_USER_EMAIL: 'dev@local'
    # Map host port 8001 to container port 8000 (no image rebuild required)
    ports:
      - "8001:8000"
    # If you want to persist changes to the backend .env during dev, consider mounting a local .env
    # volumes:
    #   - ./backend/.env:/app/.env

  frontend:
    # Mount the dev nginx conf so the running container will inject the dev header when proxying
    volumes:
      - ./frontend/dist:/usr/share/nginx/html:ro
      - ./frontend/nginx.dev.conf:/etc/nginx/conf.d/default.conf:ro
    # Optional: expose port 4200 for dev debugging if you prefer the Angular dev server
    # ports:
    #   - "4200:80"
